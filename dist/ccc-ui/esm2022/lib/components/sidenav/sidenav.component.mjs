import { CommonModule } from "@angular/common";
import { Component, DestroyRef, inject, Input } from "@angular/core";
import { takeUntilDestroyed } from "@angular/core/rxjs-interop";
import { MatButtonModule } from "@angular/material/button";
import { MatExpansionModule } from "@angular/material/expansion";
import { MatIconModule } from "@angular/material/icon";
import { MatSidenavModule } from "@angular/material/sidenav";
import { RouterModule } from "@angular/router";
import { Store } from "@ngxs/store";
import { tap } from "rxjs";
import { HasPermissionDirective } from "../../directives/has-permission.directive";
import { CoreState } from "../../state/core.state";
import * as i0 from "@angular/core";
import * as i1 from "@angular/material/icon";
import * as i2 from "@angular/router";
import * as i3 from "@angular/common";
export class SidenavComponent {
    store = inject(Store);
    destroyRef = inject(DestroyRef);
    navGroups;
    currentNav = [];
    hasPermissionFn = this.store.select(CoreState.hasPermission);
    ngOnInit() {
        this.store
            .select(CoreState.currentSidenavIdentifier)
            .pipe(tap((identifier) => {
            this.currentNav = this.updateNavItems(identifier);
        }), takeUntilDestroyed(this.destroyRef))
            .subscribe();
    }
    /**
     * Updates the currentNav based on the identifier
     * @param identifier
     * @returns NavItem[]
     * @memberof SidenavComponent
     */
    updateNavItems(identifier) {
        if (!this.navGroups) {
            return [];
        }
        if (!this.navGroups[identifier]) {
            // pick the first one if the identifier is not found so we don't break the UI
            identifier = Object.keys(this.navGroups)[0];
        }
        return this.navGroups[identifier];
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.7", ngImport: i0, type: SidenavComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.7", type: SidenavComponent, isStandalone: true, selector: "app-sidenav", inputs: { navGroups: "navGroups" }, ngImport: i0, template: "<div class=\"nav-container\">\n  <nav>\n    @for (navItem of currentNav; track navItem.label) {\n      <ng-container *ngTemplateOutlet=\"typeRendererTemplate; context: { navItem: navItem }\"></ng-container>\n    }\n  </nav>\n</div>\n<ng-template #typeRendererTemplate let-navItem=\"navItem\">\n  @switch (navItem.type) {\n    @case ('header') {\n      <ng-container [ngTemplateOutlet]=\"headerTemplate\" [ngTemplateOutletContext]=\"{ navItem: navItem }\"></ng-container>\n    }\n    @case ('link') {\n      <ng-container [ngTemplateOutlet]=\"linkTemplate\" [ngTemplateOutletContext]=\"{ navItem: navItem }\"></ng-container>\n    }\n    @case ('expandable') {\n      <ng-container\n        [ngTemplateOutlet]=\"expandableTemplate\"\n        [ngTemplateOutletContext]=\"{ navItem: navItem }\"></ng-container>\n    }\n  }\n</ng-template>\n<ng-template #headerTemplate let-navItem=\"navItem\">\n  <div class=\"link-header\">{{ navItem.label }}</div>\n</ng-template>\n<ng-template #linkTemplate let-navItem=\"navItem\">\n  @if (navItem.permissions.length === 0) {\n    <a [routerLink]=\"navItem.routerLink\">\n      <div class=\"nav-item\" routerLinkActive=\"active-link\">\n        <div class=\"link-button\">\n          <div class=\"icon\">\n            <mat-icon class=\"material-icons-outlined\" [inline]=\"true\">\n              {{ navItem.icon }}\n            </mat-icon>\n          </div>\n          <div class=\"text\">\n            {{ navItem.label | titlecase }}\n          </div>\n        </div>\n      </div>\n    </a>\n  }\n  @if (navItem.permissions.length > 0) {\n    <a [routerLink]=\"navItem.routerLink\" *appHasPermission=\"navItem.permissions\">\n      <ng-container *ngTemplateOutlet=\"navItemTemplate\"></ng-container>\n    </a>\n  }\n  <ng-template #navItemTemplate>\n    <div class=\"nav-item\" routerLinkActive=\"active-link\">\n      <div class=\"link-button\">\n        <div class=\"icon\">\n          <mat-icon class=\"material-icons-outlined\" [inline]=\"true\">\n            {{ navItem.icon }}\n          </mat-icon>\n        </div>\n        <div class=\"text\">\n          {{ navItem.label | titlecase }}\n        </div>\n      </div>\n    </div>\n  </ng-template>\n</ng-template>\n<ng-template #expandableTemplate let-navItem=\"navItem\">\n  <div class=\"nav-item\" aria-hidden=\"true\" (click)=\"navItem.isExpanded = !navItem.isExpanded\">\n    <div class=\"link-button\">\n      <div class=\"icon\">\n        <mat-icon class=\"material-icons-outlined\" [inline]=\"true\">\n          {{ navItem.isExpanded ? 'expand_less' : 'expand_more' }}\n        </mat-icon>\n      </div>\n      <div class=\"text\">{{ navItem.label }}</div>\n    </div>\n  </div>\n  @if (navItem.isExpanded) {\n    <div class=\"expandable-links\">\n      @for (navItemChild of navItem.children; track navItemChild) {\n        <ng-container *ngTemplateOutlet=\"typeRendererTemplate; context: { navItem: navItemChild }\"> </ng-container>\n      }\n    </div>\n  }\n</ng-template>\n", styles: [".nav-container{padding:0;height:100%}nav{max-width:100%;margin:0 10px}.nav-item{width:100%;height:48px;font-size:18px;display:flex;flex-direction:column;justify-content:center;color:#003b49;padding:0 15px;position:relative}.nav-item:hover{background-color:#0000000a;transition:background-color .1s ease}.nav-item:active{background-color:#0000001a;transition:background-color .1s ease}.link-header{color:#003b49;text-transform:uppercase;font-weight:700;font-size:12px;margin:20px 0 0 5px}.link-button{display:flex;flex-direction:row;width:100%}.link-button .icon{min-width:20px;margin-right:10px;display:flex;flex-direction:column;justify-content:center}.link-button .text{margin-right:10px;text-align:left;display:flex;flex-direction:row;justify-content:left;text-decoration:capitalize}.expandable-links{display:flex;flex-direction:column;width:100%;padding-left:30px}a:active,a:link,a:visited{color:#003b49!important}a{text-decoration:none}.active-link:before{content:\"\";position:absolute;left:3px;width:5px;height:38px;background-color:#003b49}.active-link{background-color:#0000000a;position:relative}\n"], dependencies: [{ kind: "ngmodule", type: MatIconModule }, { kind: "component", type: i1.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { kind: "ngmodule", type: RouterModule }, { kind: "directive", type: i2.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "info", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "directive", type: i2.RouterLinkActive, selector: "[routerLinkActive]", inputs: ["routerLinkActiveOptions", "ariaCurrentWhenActive", "routerLinkActive"], outputs: ["isActiveChange"], exportAs: ["routerLinkActive"] }, { kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i3.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "pipe", type: i3.TitleCasePipe, name: "titlecase" }, { kind: "ngmodule", type: MatExpansionModule }, { kind: "ngmodule", type: MatButtonModule }, { kind: "directive", type: HasPermissionDirective, selector: "[appHasPermission]", inputs: ["appHasPermission"] }, { kind: "ngmodule", type: MatSidenavModule }] });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.7", ngImport: i0, type: SidenavComponent, decorators: [{
            type: Component,
            args: [{ selector: "app-sidenav", standalone: true, imports: [
                        MatIconModule,
                        RouterModule,
                        CommonModule,
                        MatExpansionModule,
                        MatButtonModule,
                        HasPermissionDirective,
                        MatSidenavModule,
                    ], template: "<div class=\"nav-container\">\n  <nav>\n    @for (navItem of currentNav; track navItem.label) {\n      <ng-container *ngTemplateOutlet=\"typeRendererTemplate; context: { navItem: navItem }\"></ng-container>\n    }\n  </nav>\n</div>\n<ng-template #typeRendererTemplate let-navItem=\"navItem\">\n  @switch (navItem.type) {\n    @case ('header') {\n      <ng-container [ngTemplateOutlet]=\"headerTemplate\" [ngTemplateOutletContext]=\"{ navItem: navItem }\"></ng-container>\n    }\n    @case ('link') {\n      <ng-container [ngTemplateOutlet]=\"linkTemplate\" [ngTemplateOutletContext]=\"{ navItem: navItem }\"></ng-container>\n    }\n    @case ('expandable') {\n      <ng-container\n        [ngTemplateOutlet]=\"expandableTemplate\"\n        [ngTemplateOutletContext]=\"{ navItem: navItem }\"></ng-container>\n    }\n  }\n</ng-template>\n<ng-template #headerTemplate let-navItem=\"navItem\">\n  <div class=\"link-header\">{{ navItem.label }}</div>\n</ng-template>\n<ng-template #linkTemplate let-navItem=\"navItem\">\n  @if (navItem.permissions.length === 0) {\n    <a [routerLink]=\"navItem.routerLink\">\n      <div class=\"nav-item\" routerLinkActive=\"active-link\">\n        <div class=\"link-button\">\n          <div class=\"icon\">\n            <mat-icon class=\"material-icons-outlined\" [inline]=\"true\">\n              {{ navItem.icon }}\n            </mat-icon>\n          </div>\n          <div class=\"text\">\n            {{ navItem.label | titlecase }}\n          </div>\n        </div>\n      </div>\n    </a>\n  }\n  @if (navItem.permissions.length > 0) {\n    <a [routerLink]=\"navItem.routerLink\" *appHasPermission=\"navItem.permissions\">\n      <ng-container *ngTemplateOutlet=\"navItemTemplate\"></ng-container>\n    </a>\n  }\n  <ng-template #navItemTemplate>\n    <div class=\"nav-item\" routerLinkActive=\"active-link\">\n      <div class=\"link-button\">\n        <div class=\"icon\">\n          <mat-icon class=\"material-icons-outlined\" [inline]=\"true\">\n            {{ navItem.icon }}\n          </mat-icon>\n        </div>\n        <div class=\"text\">\n          {{ navItem.label | titlecase }}\n        </div>\n      </div>\n    </div>\n  </ng-template>\n</ng-template>\n<ng-template #expandableTemplate let-navItem=\"navItem\">\n  <div class=\"nav-item\" aria-hidden=\"true\" (click)=\"navItem.isExpanded = !navItem.isExpanded\">\n    <div class=\"link-button\">\n      <div class=\"icon\">\n        <mat-icon class=\"material-icons-outlined\" [inline]=\"true\">\n          {{ navItem.isExpanded ? 'expand_less' : 'expand_more' }}\n        </mat-icon>\n      </div>\n      <div class=\"text\">{{ navItem.label }}</div>\n    </div>\n  </div>\n  @if (navItem.isExpanded) {\n    <div class=\"expandable-links\">\n      @for (navItemChild of navItem.children; track navItemChild) {\n        <ng-container *ngTemplateOutlet=\"typeRendererTemplate; context: { navItem: navItemChild }\"> </ng-container>\n      }\n    </div>\n  }\n</ng-template>\n", styles: [".nav-container{padding:0;height:100%}nav{max-width:100%;margin:0 10px}.nav-item{width:100%;height:48px;font-size:18px;display:flex;flex-direction:column;justify-content:center;color:#003b49;padding:0 15px;position:relative}.nav-item:hover{background-color:#0000000a;transition:background-color .1s ease}.nav-item:active{background-color:#0000001a;transition:background-color .1s ease}.link-header{color:#003b49;text-transform:uppercase;font-weight:700;font-size:12px;margin:20px 0 0 5px}.link-button{display:flex;flex-direction:row;width:100%}.link-button .icon{min-width:20px;margin-right:10px;display:flex;flex-direction:column;justify-content:center}.link-button .text{margin-right:10px;text-align:left;display:flex;flex-direction:row;justify-content:left;text-decoration:capitalize}.expandable-links{display:flex;flex-direction:column;width:100%;padding-left:30px}a:active,a:link,a:visited{color:#003b49!important}a{text-decoration:none}.active-link:before{content:\"\";position:absolute;left:3px;width:5px;height:38px;background-color:#003b49}.active-link{background-color:#0000000a;position:relative}\n"] }]
        }], propDecorators: { navGroups: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lkZW5hdi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jY2MtbGliL3NyYy9saWIvY29tcG9uZW50cy9zaWRlbmF2L3NpZGVuYXYuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvY2NjLWxpYi9zcmMvbGliL2NvbXBvbmVudHMvc2lkZW5hdi9zaWRlbmF2LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQzdFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUNqRSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDdkQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDN0QsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQy9DLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFDcEMsT0FBTyxFQUFjLEdBQUcsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUN2QyxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSwyQ0FBMkMsQ0FBQztBQUNuRixPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sd0JBQXdCLENBQUM7Ozs7O0FBOEJuRCxNQUFNLE9BQU8sZ0JBQWdCO0lBQ25CLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdEIsVUFBVSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUUvQixTQUFTLENBQWE7SUFDL0IsVUFBVSxHQUFjLEVBQUUsQ0FBQztJQUUzQixlQUFlLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBRTdELFFBQVE7UUFDTixJQUFJLENBQUMsS0FBSzthQUNQLE1BQU0sQ0FBQyxTQUFTLENBQUMsd0JBQXdCLENBQUM7YUFDMUMsSUFBSSxDQUNILEdBQUcsQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFO1lBQ2pCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNwRCxDQUFDLENBQUMsRUFDRixrQkFBa0IsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQ3BDO2FBQ0EsU0FBUyxFQUFFLENBQUM7SUFDakIsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsY0FBYyxDQUFDLFVBQWtCO1FBQy9CLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDcEIsT0FBTyxFQUFFLENBQUM7UUFDWixDQUFDO1FBQ0QsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztZQUNoQyw2RUFBNkU7WUFDN0UsVUFBVSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzlDLENBQUM7UUFDRCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDcEMsQ0FBQzt1R0FwQ1UsZ0JBQWdCOzJGQUFoQixnQkFBZ0IsMkdDekM3QixtNkZBaUZBLDZvQ0RqREksYUFBYSxtTEFDYixZQUFZLGdmQUNaLFlBQVksa1FBQ1osa0JBQWtCLDhCQUNsQixlQUFlLCtCQUNmLHNCQUFzQiw0RkFDdEIsZ0JBQWdCOzsyRkFHUCxnQkFBZ0I7a0JBZjVCLFNBQVM7K0JBQ0UsYUFBYSxjQUdYLElBQUksV0FDUDt3QkFDUCxhQUFhO3dCQUNiLFlBQVk7d0JBQ1osWUFBWTt3QkFDWixrQkFBa0I7d0JBQ2xCLGVBQWU7d0JBQ2Ysc0JBQXNCO3dCQUN0QixnQkFBZ0I7cUJBQ2pCOzhCQU1RLFNBQVM7c0JBQWpCLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21tb25Nb2R1bGUgfSBmcm9tIFwiQGFuZ3VsYXIvY29tbW9uXCI7XG5pbXBvcnQgeyBDb21wb25lbnQsIERlc3Ryb3lSZWYsIGluamVjdCwgSW5wdXQsIE9uSW5pdCB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyB0YWtlVW50aWxEZXN0cm95ZWQgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZS9yeGpzLWludGVyb3BcIjtcbmltcG9ydCB7IE1hdEJ1dHRvbk1vZHVsZSB9IGZyb20gXCJAYW5ndWxhci9tYXRlcmlhbC9idXR0b25cIjtcbmltcG9ydCB7IE1hdEV4cGFuc2lvbk1vZHVsZSB9IGZyb20gXCJAYW5ndWxhci9tYXRlcmlhbC9leHBhbnNpb25cIjtcbmltcG9ydCB7IE1hdEljb25Nb2R1bGUgfSBmcm9tIFwiQGFuZ3VsYXIvbWF0ZXJpYWwvaWNvblwiO1xuaW1wb3J0IHsgTWF0U2lkZW5hdk1vZHVsZSB9IGZyb20gXCJAYW5ndWxhci9tYXRlcmlhbC9zaWRlbmF2XCI7XG5pbXBvcnQgeyBSb3V0ZXJNb2R1bGUgfSBmcm9tIFwiQGFuZ3VsYXIvcm91dGVyXCI7XG5pbXBvcnQgeyBTdG9yZSB9IGZyb20gXCJAbmd4cy9zdG9yZVwiO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgdGFwIH0gZnJvbSBcInJ4anNcIjtcbmltcG9ydCB7IEhhc1Blcm1pc3Npb25EaXJlY3RpdmUgfSBmcm9tIFwiLi4vLi4vZGlyZWN0aXZlcy9oYXMtcGVybWlzc2lvbi5kaXJlY3RpdmVcIjtcbmltcG9ydCB7IENvcmVTdGF0ZSB9IGZyb20gXCIuLi8uLi9zdGF0ZS9jb3JlLnN0YXRlXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTmF2SXRlbSB7XG4gIHR5cGU6IFwibGlua1wiIHwgXCJoZWFkZXJcIiB8IFwiZXhwYW5kYWJsZVwiO1xuICByb3V0ZXJMaW5rPzogc3RyaW5nW107XG4gIGxhYmVsOiBzdHJpbmc7XG4gIGljb24/OiBzdHJpbmc7XG4gIHBlcm1pc3Npb25zOiBQZXJtaXNzaW9uc1tdO1xuICBjaGlsZHJlbj86IE5hdkl0ZW1bXTtcbiAgaXNFeHBhbmRlZD86IGJvb2xlYW47XG4gIGF0dGVudGlvbkNvdW50PzogT2JzZXJ2YWJsZTxudW1iZXI+O1xufVxuXG5leHBvcnQgdHlwZSBOYXZHcm91cHMgPSBSZWNvcmQ8c3RyaW5nLCBOYXZJdGVtW10+O1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6IFwiYXBwLXNpZGVuYXZcIixcbiAgdGVtcGxhdGVVcmw6IFwiLi9zaWRlbmF2LmNvbXBvbmVudC5odG1sXCIsXG4gIHN0eWxlVXJsczogW1wiLi9zaWRlbmF2LmNvbXBvbmVudC5zY3NzXCJdLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbXG4gICAgTWF0SWNvbk1vZHVsZSxcbiAgICBSb3V0ZXJNb2R1bGUsXG4gICAgQ29tbW9uTW9kdWxlLFxuICAgIE1hdEV4cGFuc2lvbk1vZHVsZSxcbiAgICBNYXRCdXR0b25Nb2R1bGUsXG4gICAgSGFzUGVybWlzc2lvbkRpcmVjdGl2ZSxcbiAgICBNYXRTaWRlbmF2TW9kdWxlLFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBTaWRlbmF2Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgcHJpdmF0ZSBzdG9yZSA9IGluamVjdChTdG9yZSk7XG4gIHByaXZhdGUgZGVzdHJveVJlZiA9IGluamVjdChEZXN0cm95UmVmKTtcblxuICBASW5wdXQoKSBuYXZHcm91cHM/OiBOYXZHcm91cHM7XG4gIGN1cnJlbnROYXY6IE5hdkl0ZW1bXSA9IFtdO1xuXG4gIGhhc1Blcm1pc3Npb25GbiA9IHRoaXMuc3RvcmUuc2VsZWN0KENvcmVTdGF0ZS5oYXNQZXJtaXNzaW9uKTtcblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnN0b3JlXG4gICAgICAuc2VsZWN0KENvcmVTdGF0ZS5jdXJyZW50U2lkZW5hdklkZW50aWZpZXIpXG4gICAgICAucGlwZShcbiAgICAgICAgdGFwKChpZGVudGlmaWVyKSA9PiB7XG4gICAgICAgICAgdGhpcy5jdXJyZW50TmF2ID0gdGhpcy51cGRhdGVOYXZJdGVtcyhpZGVudGlmaWVyKTtcbiAgICAgICAgfSksXG4gICAgICAgIHRha2VVbnRpbERlc3Ryb3llZCh0aGlzLmRlc3Ryb3lSZWYpXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgY3VycmVudE5hdiBiYXNlZCBvbiB0aGUgaWRlbnRpZmllclxuICAgKiBAcGFyYW0gaWRlbnRpZmllclxuICAgKiBAcmV0dXJucyBOYXZJdGVtW11cbiAgICogQG1lbWJlcm9mIFNpZGVuYXZDb21wb25lbnRcbiAgICovXG4gIHVwZGF0ZU5hdkl0ZW1zKGlkZW50aWZpZXI6IHN0cmluZyk6IE5hdkl0ZW1bXSB7XG4gICAgaWYgKCF0aGlzLm5hdkdyb3Vwcykge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBpZiAoIXRoaXMubmF2R3JvdXBzW2lkZW50aWZpZXJdKSB7XG4gICAgICAvLyBwaWNrIHRoZSBmaXJzdCBvbmUgaWYgdGhlIGlkZW50aWZpZXIgaXMgbm90IGZvdW5kIHNvIHdlIGRvbid0IGJyZWFrIHRoZSBVSVxuICAgICAgaWRlbnRpZmllciA9IE9iamVjdC5rZXlzKHRoaXMubmF2R3JvdXBzKVswXTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMubmF2R3JvdXBzW2lkZW50aWZpZXJdO1xuICB9XG59XG4iLCI8ZGl2IGNsYXNzPVwibmF2LWNvbnRhaW5lclwiPlxuICA8bmF2PlxuICAgIEBmb3IgKG5hdkl0ZW0gb2YgY3VycmVudE5hdjsgdHJhY2sgbmF2SXRlbS5sYWJlbCkge1xuICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cInR5cGVSZW5kZXJlclRlbXBsYXRlOyBjb250ZXh0OiB7IG5hdkl0ZW06IG5hdkl0ZW0gfVwiPjwvbmctY29udGFpbmVyPlxuICAgIH1cbiAgPC9uYXY+XG48L2Rpdj5cbjxuZy10ZW1wbGF0ZSAjdHlwZVJlbmRlcmVyVGVtcGxhdGUgbGV0LW5hdkl0ZW09XCJuYXZJdGVtXCI+XG4gIEBzd2l0Y2ggKG5hdkl0ZW0udHlwZSkge1xuICAgIEBjYXNlICgnaGVhZGVyJykge1xuICAgICAgPG5nLWNvbnRhaW5lciBbbmdUZW1wbGF0ZU91dGxldF09XCJoZWFkZXJUZW1wbGF0ZVwiIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IG5hdkl0ZW06IG5hdkl0ZW0gfVwiPjwvbmctY29udGFpbmVyPlxuICAgIH1cbiAgICBAY2FzZSAoJ2xpbmsnKSB7XG4gICAgICA8bmctY29udGFpbmVyIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImxpbmtUZW1wbGF0ZVwiIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IG5hdkl0ZW06IG5hdkl0ZW0gfVwiPjwvbmctY29udGFpbmVyPlxuICAgIH1cbiAgICBAY2FzZSAoJ2V4cGFuZGFibGUnKSB7XG4gICAgICA8bmctY29udGFpbmVyXG4gICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImV4cGFuZGFibGVUZW1wbGF0ZVwiXG4gICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IG5hdkl0ZW06IG5hdkl0ZW0gfVwiPjwvbmctY29udGFpbmVyPlxuICAgIH1cbiAgfVxuPC9uZy10ZW1wbGF0ZT5cbjxuZy10ZW1wbGF0ZSAjaGVhZGVyVGVtcGxhdGUgbGV0LW5hdkl0ZW09XCJuYXZJdGVtXCI+XG4gIDxkaXYgY2xhc3M9XCJsaW5rLWhlYWRlclwiPnt7IG5hdkl0ZW0ubGFiZWwgfX08L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG48bmctdGVtcGxhdGUgI2xpbmtUZW1wbGF0ZSBsZXQtbmF2SXRlbT1cIm5hdkl0ZW1cIj5cbiAgQGlmIChuYXZJdGVtLnBlcm1pc3Npb25zLmxlbmd0aCA9PT0gMCkge1xuICAgIDxhIFtyb3V0ZXJMaW5rXT1cIm5hdkl0ZW0ucm91dGVyTGlua1wiPlxuICAgICAgPGRpdiBjbGFzcz1cIm5hdi1pdGVtXCIgcm91dGVyTGlua0FjdGl2ZT1cImFjdGl2ZS1saW5rXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJsaW5rLWJ1dHRvblwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJpY29uXCI+XG4gICAgICAgICAgICA8bWF0LWljb24gY2xhc3M9XCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZFwiIFtpbmxpbmVdPVwidHJ1ZVwiPlxuICAgICAgICAgICAgICB7eyBuYXZJdGVtLmljb24gfX1cbiAgICAgICAgICAgIDwvbWF0LWljb24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInRleHRcIj5cbiAgICAgICAgICAgIHt7IG5hdkl0ZW0ubGFiZWwgfCB0aXRsZWNhc2UgfX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L2E+XG4gIH1cbiAgQGlmIChuYXZJdGVtLnBlcm1pc3Npb25zLmxlbmd0aCA+IDApIHtcbiAgICA8YSBbcm91dGVyTGlua109XCJuYXZJdGVtLnJvdXRlckxpbmtcIiAqYXBwSGFzUGVybWlzc2lvbj1cIm5hdkl0ZW0ucGVybWlzc2lvbnNcIj5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJuYXZJdGVtVGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cbiAgICA8L2E+XG4gIH1cbiAgPG5nLXRlbXBsYXRlICNuYXZJdGVtVGVtcGxhdGU+XG4gICAgPGRpdiBjbGFzcz1cIm5hdi1pdGVtXCIgcm91dGVyTGlua0FjdGl2ZT1cImFjdGl2ZS1saW5rXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwibGluay1idXR0b25cIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImljb25cIj5cbiAgICAgICAgICA8bWF0LWljb24gY2xhc3M9XCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZFwiIFtpbmxpbmVdPVwidHJ1ZVwiPlxuICAgICAgICAgICAge3sgbmF2SXRlbS5pY29uIH19XG4gICAgICAgICAgPC9tYXQtaWNvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0XCI+XG4gICAgICAgICAge3sgbmF2SXRlbS5sYWJlbCB8IHRpdGxlY2FzZSB9fVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L25nLXRlbXBsYXRlPlxuPC9uZy10ZW1wbGF0ZT5cbjxuZy10ZW1wbGF0ZSAjZXhwYW5kYWJsZVRlbXBsYXRlIGxldC1uYXZJdGVtPVwibmF2SXRlbVwiPlxuICA8ZGl2IGNsYXNzPVwibmF2LWl0ZW1cIiBhcmlhLWhpZGRlbj1cInRydWVcIiAoY2xpY2spPVwibmF2SXRlbS5pc0V4cGFuZGVkID0gIW5hdkl0ZW0uaXNFeHBhbmRlZFwiPlxuICAgIDxkaXYgY2xhc3M9XCJsaW5rLWJ1dHRvblwiPlxuICAgICAgPGRpdiBjbGFzcz1cImljb25cIj5cbiAgICAgICAgPG1hdC1pY29uIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIiBbaW5saW5lXT1cInRydWVcIj5cbiAgICAgICAgICB7eyBuYXZJdGVtLmlzRXhwYW5kZWQgPyAnZXhwYW5kX2xlc3MnIDogJ2V4cGFuZF9tb3JlJyB9fVxuICAgICAgICA8L21hdC1pY29uPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwidGV4dFwiPnt7IG5hdkl0ZW0ubGFiZWwgfX08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG4gIEBpZiAobmF2SXRlbS5pc0V4cGFuZGVkKSB7XG4gICAgPGRpdiBjbGFzcz1cImV4cGFuZGFibGUtbGlua3NcIj5cbiAgICAgIEBmb3IgKG5hdkl0ZW1DaGlsZCBvZiBuYXZJdGVtLmNoaWxkcmVuOyB0cmFjayBuYXZJdGVtQ2hpbGQpIHtcbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cInR5cGVSZW5kZXJlclRlbXBsYXRlOyBjb250ZXh0OiB7IG5hdkl0ZW06IG5hdkl0ZW1DaGlsZCB9XCI+IDwvbmctY29udGFpbmVyPlxuICAgICAgfVxuICAgIDwvZGl2PlxuICB9XG48L25nLXRlbXBsYXRlPlxuIl19